"ui";
ui.layout(
    <vertical>
        <appbar>
            <toolbar title="钢琴脚本播放器"/>
        </appbar>
        <Switch id="autoService" text="无障碍服务" checked="{{auto.service != null}}" padding="8 8 8 8" textSize="15sp"/>
 
        <button id="start" bg="#00be00" margin="20px" text="开启运行软件"/>
        <button id="babys" bg="#770000ff" margin="20px" text="点击添加可达鸭"/>
        <button id="train" bg="#77ffff00" margin="20px" text="点击添加Q群"/>
        <frame h="*">
          <text text="作者:可达鸭，QQ1486756416" padding="30px" gravity="center|bottom"/>
        </frame>
    </vertical>
);
注册码 = "dE6nNuFsjeZPqLgaMv9xSFDF2BmAFlR38KrPZpjFilhkFbz+3fpwEoCIAFNh/Eqw";






code = "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"; 
var storage=storages.create("jsplayer");

var fw=null;
ui.autoService.on("check", function(checked) {
    // 用户勾选无障碍服务的选项时，跳转到页面让用户去开启
    if(checked && auto.service == null) {
        app.startActivity({
            action: "android.settings.ACCESSIBILITY_SETTINGS"
        });
    }
    if(!checked && auto.service != null){
        auto.service.disableSelf();
    }
});

// 当用户回到本界面时，resume事件会被触发
ui.emitter.on("resume", function() {
    // 此时根据无障碍服务的开启情况，同步开关的状态
    ui.autoService.checked = auto.service != null;
});

ui.start.on("click", function(){
    //程序开始运行之前判断无障碍服务
    if(auto.service == null) {
        toast("请先开启无障碍服务！");
        return;
    }
    if (storage.get("read","-1")=="-1"){
        toast("请先点击下方添加Q群后重试！");
        return; 
    }
    if (fw){fw.getEngine().forceStop();};
    fw=engines.execScriptFile("./floatyw.js");
});


ui.babys.on("click",function(){
    storage.put("read","1");
     app.openUrl("https://qm.qq.com/cgi-bin/qm/qr?k=uD8sZebmjIxCRMr_o3-FX8rWifFTT9Rh");
   }
);
